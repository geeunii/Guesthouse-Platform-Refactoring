<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Concurrency Control</title>
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/concurrency.css">
</head>

<body>
    <div class="presentation" id="presentation">
        <section class="slide slide-concurrency active" data-slide="15">
            <h2 class="section-title animate-in">동시성 제어 <span class="sub-title">— Redis 분산 락</span></h2>
            <div class="concurrency-content animate-in">
                <div class="concurrency-box problem">
                    <div class="box-header problem">
                        <span class="header-icon">🔥</span>
                        <span class="header-text">문제</span>
                    </div>
                    <div class="box-body">
                        <div class="test-scenario">
                            <span class="label">테스트 시나리오</span>
                            <p>객실 정원 <strong>6명</strong>, 동시 예약 <strong>10명</strong></p>
                        </div>
                        <div class="issue-detail">
                            <span class="label">발생 문제</span>
                            <p>10명 전원 예약 성공 😱</p>
                        </div>
                        <div class="cause">
                            <span class="label">원인</span>
                            <p>Race Condition<br><small>DB 조회 → 정원 체크 → 저장 사이 동시 접근</small></p>
                        </div>
                    </div>
                </div>
                <div class="concurrency-arrow">→</div>
                <div class="concurrency-box solution">
                    <div class="box-header solution">
                        <span class="header-icon">🔧</span>
                        <span class="header-text">개선</span>
                    </div>
                    <div class="box-body">
                        <div class="solution-method">
                            <span class="label">적용 기술</span>
                            <p><code>Redisson</code> 분산 락 + <code>DB</code> 비관적 락</p>
                        </div>
                        <div class="solution-code">
                            <span class="label">구현 방식</span>
                            <p><code>@DistributedLock</code> + <code>@Lock(Read)</code></p>
                        </div>
                        <div class="solution-flow">
                            <span class="label">처리 흐름</span>
                            <p>분산 락 획득 → DB Row 락(Read) → 예약 → 해제</p>
                        </div>
                    </div>
                </div>
                <div class="concurrency-arrow">→</div>
                <div class="concurrency-box solution">
                    <div class="box-header solution">
                        <span class="header-icon">✅</span>
                        <span class="header-text">해결</span>
                    </div>
                    <div class="box-body">
                        <div class="test-scenario">
                            <span class="label">테스트 결과</span>
                            <p><strong class="success">6명 성공</strong>, <strong class="fail">4명 실패</strong></p>
                        </div>
                        <div class="issue-detail">
                            <span class="label">효과</span>
                            <p>순차적 락 획득으로<br>오버부킹 완전 방지</p>
                        </div>
                        <div class="cause">
                            <span class="label">검증 방법</span>
                            <p>JUnit 동시성 테스트<br><small>10스레드 동시 실행</small></p>
                        </div>
                    </div>
                </div>
                <!-- 결과 화면 -->
                <div class="concurrency-result-phone">
                    <div class="phone-frame-modern phone-result">
                        <img src="./images/concurrency-result.png" alt="예약 실패 화면">
                    </div>
                    <div class="result-caption">락 미획득 시 실패 처리</div>
                </div>
            </div>
        </section>
    </div>

    <!-- Slide Indicator -->
    <div class="slide-indicator" id="indicator"></div>

    <!-- Progress Bar -->
    <div class="progress-bar" id="progressBar"></div>

    <script src="js/presentation.js"></script>
</body>

</html>